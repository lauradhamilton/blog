(function(a){var h=function(f,h){a.each(h,function(a,h){f=f.replace(RegExp("{{ *"+a+" *}}"),h)});return f};a(function(){var f=a("#wp_rp_earnings_wrap"),C=a("#wp_rp_earnings_holder"),i=a("#wp_rp_statistics_wrap"),D=a("#wp_rp_dashboard_url").val(),m=a("#wp_rp_blog_id").val(),v=a("#wp_rp_auth_key").val(),n=a("#wp_rp_ajax_nonce").val(),E=0<a("#wp_rp_show_traffic_exchange_statistics").length,F=0<a("#wp_rp_show_promoted_content_statistics").length,w=null,s=null,p=!1,d=null,j,k,l,q,t,r,x=function(a){a||
(a=5E3);clearInterval(s);0<a&&(s=setInterval(u,a))},y=function(c,b){a.ajax({url:ajaxurl,data:{action:"wprp_subscribe",_wpnonce:n,email:c||"0"},success:b,type:"POST"})},z=function(){var c=1!==a("#wp_rp_desktop_custom_theme_enabled:checked").length;a("#wp_rp_desktop_theme_custom_css").prop("readonly",c)},A=function(c){var b=a("#wp_rp_statistics_wrap");c||b.find(".unavailable").slideDown();x(3E4);p=!1},u=function(c){p||(p=!0,w=setTimeout(function(){A(!c)},2E3),a.getJSON(D+"pageviews/?callback=?",{blog_id:m,
auth_key:v},function(b){var e=b.data;clearTimeout(w);if(!b||"ok"!==b.status||!b.data)A(!c);else{d||(d=a('<ul class="statistics" />'),i.find(".unavailable").slideUp(),d.append('<li class="title"><div class="desktop">Desktop</div><div class="mobile">Mobile</div></li>'),d.append(h('<li class="{{class}} stats"><p class="num mobile"></p><p class="num all"></p><h5>{{ title}}<span>{{range}}</span></h5></li>',{"class":"ctr",title:"click-through rate",range:"last 30 days"})),d.append(h('<li class="{{class}} stats"><p class="num mobile"></p><p class="num all"></p><h5>{{ title}}<span>{{range}}</span></h5></li>',
{"class":"pageviews",title:"page views",range:"last 30 days"})),d.append(h('<li class="{{class}} stats"><p class="num mobile"></p><p class="num all"></p><h5>{{ title}}<span>{{range}}</span></h5></li>',{"class":"clicks",title:"clicks",range:"last 30 days"})),i.append(d),E&&i.append('<div class="network"><div class="icon"></div><span class="num"></span><h4>Inbound Visitors</h4><div class="description"><p>Number of visitors that came to your site because this plugin promoted your content on other sites.<strong>Wow, a traffic exchange! :)</strong></p></div></div>'),
i.parents(".collapsed").length&&i.parent().hide());x(b.data.update_interval);j=Math.max(e.mobile_pageviews,j||0);k=Math.max(e.mobile_clicks,k||0);b=0<j&&(100*(k/j)).toFixed(1)||0;l=Math.max(e.pageviews-j,l||0);q=Math.max(e.clicks-k,q||0);var G=0<l&&(100*(q/l)).toFixed(1)||0;t=Math.max(e.network_in_pageviews,t||0);if(F&&e.promoted_content_money_earned){r=Math.max(e.promoted_content_money_earned,r||0);var g=(r/100).toFixed(2),H=(e.meta.min_payout/100).toFixed(2);f.find(".num").html("$"+g);f.find(".payout").html("$"+
H);r>=e.meta.min_payout&&f.find(".claim").hasClass("disabled")&&(f.find(".claim").removeClass("disabled"),f.find(".claim").attr("href","mailto:support+claim@zemanta.com?subject="+encodeURIComponent("I earned over $50!")+"&body="+encodeURIComponent("I would like to claim my money.\nMy reference code is: "+m+" \nMy PayPal account is:\n")));C.show()}d.find(".ctr .num.all").html(G+"%");d.find(".pageviews .num.all").html(l);d.find(".clicks .num.all").html(q);d.find(".ctr .num.mobile").html(b+"%");d.find(".pageviews .num.mobile").html(j);
d.find(".clicks .num.mobile").html(k);i.find(".network .num").html(t);p=!1}}))},B=function(c){a("#wp_rp_static_base_url").val();a("#wp_rp_ctr_dashboard_enabled, #wp_rp_enable_themes, #wp_rp_promoted_content_enabled, #wp_rp_traffic_exchange_enabled").prop("checked",!0);a("#wp_rp_settings_form").append('<input type="hidden" value="statistics+thumbnails+promoted" name="wp_rp_turn_on_button_pressed" id="wp_rp_turn_on_button_pressed">');a("#wp_rp_settings_form").append('<input type="hidden" value="'+c+
'" name="wp_rp_button_type" id="wp_rp_button_type">');a("#wp_rp_settings_form").submit()};z();a("#wp_rp_desktop_custom_theme_enabled").click(z);m&&v&&(u(!0),s=setInterval(u,2E3));!m&&document.location.search.match(/ref=turn-on-rp/)&&B("turn-on-banner");a("#wp_rp_turn_on_statistics a.turn-on").click(function(c){c.preventDefault();c=a(this).data("type");B(c)});a("#wp_rp_subscribe_email").length&&(a("#wp_rp_subscribe_email").val().length?a("#wp_rp_subscribe_button").hide():a("#wp_rp_unsubscribe_button").hide());
a("#wp_rp_subscribe_button").on("click",function(c){var b=a("#wp_rp_subscribe_email").val();c.preventDefault();b&&(a("#wp_rp_subscribe_button").prop("disabled",!0),y(b,function(b){parseInt(b)&&(a("#wp_rp_subscribe_button").prop("disabled",!1),a("#wp_rp_subscribe_button").hide(),a("#wp_rp_unsubscribe_button").show(),alert("Subscription successful!"))}))});a("#wp_rp_unsubscribe_button").on("click",function(c){c.preventDefault();a("#wp_rp_unsubscribe_button").prop("disabled",!0);y(!1,function(b){parseInt(b)&&
(a("#wp_rp_subscribe_email").val(""),a("#wp_rp_unsubscribe_button").prop("disabled",!1),a("#wp_rp_unsubscribe_button").hide(),a("#wp_rp_subscribe_button").show())})});a(".wp_rp_notification .close").on("click",function(c){a.ajax({url:a(this).attr("href"),data:{noredirect:!0},_wpnonce:n});a(this).parent().slideUp(function(){a(this).remove()});c.preventDefault()});a("#wp_rp_wrap .collapsible .collapse-handle").on("click",function(c){var b=a(this).closest(".collapsible"),e=b.find(".container"),d=b.hasClass("collapsed"),
g=b.attr("block");d?(e.slideDown(),a.post(ajaxurl,{action:"rp_show_hide_"+g,show:!0,_wpnonce:n})):(e.slideUp(),a.post(ajaxurl,{action:"rp_show_hide_"+g,hide:!0,_wpnonce:n}));b.toggleClass("collapsed");if("statistics"===g){var g="statistics_"+(d?"on":"off"),e=void 0,b=new Image,d="https:"===location.protocol?"https://":"http://",g={"zem-habit-platform":"wordpress-wprp","zem-habit-action":g,"zem-habit-timestamp":(new Date).getTime()},e=e||{},g=a.extend(e,g),e=d+"eyepatch.zemanta.com/log/?",f="";a.each(g,
function(a,b){f+=a+"="+encodeURIComponent(b)+"&"});d=f.slice(0,f.length-1);b.src=e+d}c.preventDefault()})})})(jQuery);
